import{a as M,b as $,c as O,d as q,e as j,f as z,g as G,h as f}from"./chunk-WNEPPICT.js";import{a as H}from"./chunk-SPGLZGH7.js";import{D as n,F as I,J as s,K as u,L as b,N as p,O as k,P as x,Q as P,R as D,S as w,T as o,U as r,V as v,W as A,X as h,Y as U,Z as a,a as B,b as T,ba as L,ca as R,da as V,q as y,s as F,sa as N,t as S,y as E}from"./chunk-NIHPDEBP.js";function J(i,t){i&1&&(o(0,"small",3),a(1,"The title is invalid."),r())}function K(i,t){i&1&&(o(0,"small",8),a(1,"The ISBN is invalid."),r())}function Q(i,t){if(i&1&&(v(0,"input",11),u()),i&2){let d=t.$implicit,e=t.$index;U();let l=V(19);s("aria-label",`Author ${e+1}`),b(d),s("aria-describedby",l?"authors-error":null)("aria-invalid",l)}}function W(i,t){i&1&&(o(0,"small",12),a(1,"At least one author must be added."),r())}function X(i,t){i&1&&(o(0,"small",15),a(1,"The description is invalid."),r())}function Y(i,t){i&1&&(o(0,"small",18),a(1,"The URL is invalid."),r())}var Z=O(i=>{f(i.title),f(i.isbn),G(i.isbn,13),z(i.isbn,13),q(i.authors,t=>t.value().some(d=>d)?void 0:{kind:"atLeastOneAuthor"}),f(i.description),f(i.imageUrl)}),g=class i{#e=y(H);#i=y(N);#t=E({isbn:"",title:"",subtitle:"",authors:[""],description:"",imageUrl:"",createdAt:new Date().toISOString()});bookForm=M(this.#t,Z);addAuthorField(){this.bookForm.authors().value.update(t=>[...t,""])}isInvalid(t){return t().touched()?t().invalid():null}async submitForm(t){t.preventDefault(),await $(this.bookForm,async d=>{let e=d().value(),l=e.authors.filter(c=>!!c),m=T(B({},e),{authors:l,createdAt:new Date().toISOString()});this.#e.create(m).subscribe(c=>{this.#i.navigate(["/books","details",c.isbn])})})}static \u0275fac=function(d){return new(d||i)};static \u0275cmp=I({type:i,selectors:[["app-book-create-page"]],decls:35,vars:26,consts:[[3,"submit"],["for","title"],["type","text","id","title",3,"field","aria-describedby","aria-invalid"],["id","title-error"],["for","subtitle"],["type","text","id","subtitle",3,"field"],["for","isbn"],["type","text","id","isbn",3,"field","aria-describedby","aria-invalid"],["id","isbn-error"],["type","button",3,"click"],["role","group"],["type","text",3,"aria-label","field","aria-describedby","aria-invalid"],["id","authors-error"],["for","description"],["id","description",3,"field","aria-describedby","aria-invalid"],["id","description-error"],["for","imageUrl"],["type","url","id","imageUrl",3,"field","aria-describedby","aria-invalid"],["id","image-url-error"],["type","submit",3,"disabled","aria-busy"]],template:function(d,e){if(d&1){let l=A();o(0,"h1"),a(1,"Create book"),r(),o(2,"form",0),h("submit",function(c){return F(l),S(e.submitForm(c))}),o(3,"label",1),a(4,"Title"),r(),v(5,"input",2),u(),p(6,J,2,0,"small",3),o(7,"label",4),a(8,"Subtitle"),r(),v(9,"input",5),u(),o(10,"label",6),a(11,"ISBN"),r(),v(12,"input",7),u(),p(13,K,2,0,"small",8),o(14,"fieldset")(15,"legend"),a(16,"Authors"),r(),o(17,"button",9),h("click",function(){return F(l),S(e.addAuthorField())}),a(18,"Add Author"),r(),L(19),o(20,"div",10),P(21,Q,1,5,"input",11,x),p(23,W,2,0,"small",12),r()(),o(24,"label",13),a(25,"Description"),r(),o(26,"textarea",14),a(27,"  "),r(),u(),p(28,X,2,0,"small",15),o(29,"label",16),a(30,"Thumbnail URL"),r(),v(31,"input",17),u(),p(32,Y,2,0,"small",18),o(33,"button",19),a(34," Save "),r()()}if(d&2){let l=e.isInvalid(e.bookForm.title);n(5),b(e.bookForm.title),s("aria-describedby",l?"title-error":null)("aria-invalid",l),n(),k(l?6:-1),n(3),b(e.bookForm.subtitle);let m=e.isInvalid(e.bookForm.isbn);n(3),b(e.bookForm.isbn),s("aria-describedby",m?"isbn-error":null)("aria-invalid",m),n(),k(m?13:-1),n(6);let c=R(e.isInvalid(e.bookForm.authors));n(2),D(e.bookForm.authors),n(2),k(c?23:-1);let C=e.isInvalid(e.bookForm.description);n(3),b(e.bookForm.description),s("aria-describedby",C?"description-error":null)("aria-invalid",C),n(2),k(C?28:-1);let _=e.isInvalid(e.bookForm.imageUrl);n(3),b(e.bookForm.imageUrl),s("aria-describedby",_?"image-url-error":null)("aria-invalid",_),n(),k(_?32:-1),n(),w("disabled",e.bookForm().invalid()),s("aria-busy",e.bookForm().submitting())}},dependencies:[j],encapsulation:2})};var ue=[{path:"",redirectTo:"create",pathMatch:"full"},{path:"create",component:g,title:"Create Book"}];export{ue as booksAdminRoutes};
